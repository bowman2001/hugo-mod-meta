{{ $desc := ""}}
{{ if .IsPage }}
    {{ with .Params.seo.description }}
        {{ $desc = . }}
    {{ else }}
        {{ if findRE `<!--more-->` .RawContent }}
            {{ $desc = ( partial "replacements.html" .Summary ) | plainify | htmlUnescape }}
        {{ else }}
            {{ with .Description }}
                {{ $desc = . | site.Home.RenderString | plainify | htmlUnescape }}
            {{ end }}
        {{ end }}
    {{ end }}
{{ else }}
    {{ with site.Params.Description }}
        {{ $desc = . }}
    {{ else }}
        {{ warnf "There is no general site description (params.description)." }}
    {{ end }}
{{ end }}
{{ return $desc }}
